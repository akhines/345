<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Grocery Assistant</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .bogo-match { background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%); border-left: 4px solid #F57F17; }
    .alternative-match { background: linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%); border-left: 4px solid #0277BD; }
    .bioengineered-warning { background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); border-left: 4px solid #C62828; }
    .selected-item { background: #E8F5E9 !important; border-left: 4px solid #2E7D32 !important; }
    .pulse { animation: pulse 2s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const categories = ['Produce', 'Meat & Protein', 'Dairy & Cheese', 'Bread & Bakery', 'Frozen', 'Snacks & Crackers', 'Pantry & Cooking', 'Beverages & Wine', 'Household & Baby', 'Pet Food'];

    // Expanded grocery data with prices
    const initialGroceries = [
      // PRODUCE
      { id: 1, name: "Organic Bananas", category: "Produce", store: "Publix", price: 0.79, isOrganic: true, preferredBrand: "Any", bioengineered: false, alternatives: ["Bananas (conventional)"] },
      { id: 2, name: "Hass Avocado", category: "Produce", store: "Publix", price: 1.11, isOrganic: false, preferredBrand: "Any", bioengineered: false, alternatives: [] },
      { id: 3, name: "Organic Honeycrisp Apple", category: "Produce", store: "Publix", price: 7.97, isOrganic: true, preferredBrand: "Any", bioengineered: false, alternatives: ["Organic Gala Apple", "Organic Fuji Apple"] },
      { id: 4, name: "GreenWise Organic Whole California Carrots", category: "Produce", store: "Publix", price: 2.27, isOrganic: true, preferredBrand: "GreenWise", bioengineered: false, alternatives: [] },
      { id: 5, name: "Cilantro", category: "Produce", store: "Publix", price: 1.69, isOrganic: false, preferredBrand: "Any", bioengineered: false, alternatives: ["Organic Cilantro"] },
      { id: 6, name: "Organic Blueberries", category: "Produce", store: "Publix", price: 5.55, isOrganic: true, preferredBrand: "Any", bioengineered: false, alternatives: [] },
      
      // MEAT & PROTEIN
      { id: 8, name: "GreenWise Boneless Skinless Chicken Breast", category: "Meat & Protein", store: "Publix", price: 8.79, isOrganic: true, preferredBrand: "GreenWise", bioengineered: false, alternatives: ["Perdue Organic Chicken Breast"] },
      { id: 9, name: "GreenWise Chicken Thighs", category: "Meat & Protein", store: "Publix", price: 4.19, isOrganic: true, preferredBrand: "GreenWise", bioengineered: false, alternatives: [] },
      { id: 16, name: "Pete & Gerry's Pasture Raised Eggs", category: "Meat & Protein", store: "Publix", price: 8.09, isOrganic: true, preferredBrand: "Pete & Gerry's", bioengineered: false, alternatives: ["Vital Farms Eggs"] },
      { id: 17, name: "Petite Filet Mignon", category: "Meat & Protein", store: "Walmart", price: 19.20, isOrganic: false, preferredBrand: "Any", bioengineered: false, alternatives: [] },
      { id: 18, name: "Ribeye Steak", category: "Meat & Protein", store: "Walmart", price: 36.07, isOrganic: false, preferredBrand: "Any", bioengineered: false, alternatives: [] },
      { id: 19, name: "Perdue Organic Chicken Breast", category: "Meat & Protein", store: "Walmart", price: 8.76, isOrganic: true, preferredBrand: "Perdue", bioengineered: false, alternatives: [] },
      
      // DAIRY & CHEESE
      { id: 20, name: "Kerrygold Butter", category: "Dairy & Cheese", store: "Publix", price: 6.91, isOrganic: false, preferredBrand: "Kerrygold", bioengineered: false, alternatives: ["Organic Valley Butter"] },
      { id: 21, name: "Chobani Greek Yogurt 4-Pack", category: "Dairy & Cheese", store: "Publix", price: 6.27, isOrganic: false, preferredBrand: "Chobani", bioengineered: false, alternatives: [] },
      { id: 22, name: "Sargento String Cheese", category: "Dairy & Cheese", store: "Walmart", price: 4.94, isOrganic: false, preferredBrand: "Sargento", bioengineered: false, alternatives: [] },
      { id: 23, name: "Sargento Colby-Jack Sticks", category: "Dairy & Cheese", store: "Walmart", price: 4.86, isOrganic: false, preferredBrand: "Sargento", bioengineered: false, alternatives: [] },
      
      // BREAD
      { id: 26, name: "Martin's Potato Bread", category: "Bread & Bakery", store: "Publix", price: 2.77, isOrganic: false, preferredBrand: "Martin's", bioengineered: true, alternatives: ["Dave's Killer Bread"] },
      { id: 27, name: "Hero Flour Tortillas", category: "Bread & Bakery", store: "Publix", price: 8.97, isOrganic: false, preferredBrand: "Hero", bioengineered: false, alternatives: [] },
      { id: 29, name: "Food for Life Bread", category: "Bread & Bakery", store: "Publix", price: 7.29, isOrganic: true, preferredBrand: "Food for Life", bioengineered: false, alternatives: [] },
      
      // FROZEN
      { id: 30, name: "GreenWise Organic Pizza", category: "Frozen", store: "Publix", price: 7.41, isOrganic: true, preferredBrand: "GreenWise", bioengineered: false, alternatives: [] },
      { id: 31, name: "Haagen-Dazs Vanilla", category: "Frozen", store: "Publix", price: 6.91, isOrganic: false, preferredBrand: "Haagen-Dazs", bioengineered: false, alternatives: [] },
      { id: 32, name: "Haagen-Dazs Chocolate", category: "Frozen", store: "Publix", price: 6.91, isOrganic: false, preferredBrand: "Haagen-Dazs", bioengineered: false, alternatives: [] },
      { id: 35, name: "Sweet Loren's Cookie Dough", category: "Frozen", store: "Publix", price: 7.75, isOrganic: true, preferredBrand: "Sweet Loren's", bioengineered: false, alternatives: [] },
      
      // SNACKS
      { id: 38, name: "Simple Mills Crackers", category: "Snacks & Crackers", store: "Walmart", price: 4.57, isOrganic: false, preferredBrand: "Simple Mills", bioengineered: false, alternatives: [] },
      { id: 44, name: "Xochitl Tortilla Chips", category: "Snacks & Crackers", store: "Publix", price: 5.71, isOrganic: true, preferredBrand: "Xochitl", bioengineered: false, alternatives: [] },
      { id: 45, name: "Annie's Cheddar Bunnies", category: "Snacks & Crackers", store: "Publix", price: 5.71, isOrganic: true, preferredBrand: "Annie's", bioengineered: false, alternatives: [] },
      { id: 53, name: "Cascadian Farm Granola", category: "Snacks & Crackers", store: "Publix", price: 7.41, isOrganic: true, preferredBrand: "Cascadian Farm", bioengineered: false, alternatives: [] },
      
      // PANTRY
      { id: 58, name: "King Arthur Bread Flour", category: "Pantry & Cooking", store: "Walmart", price: 7.87, isOrganic: true, preferredBrand: "King Arthur", bioengineered: false, alternatives: [] },
      { id: 59, name: "Bob's Red Mill Flour", category: "Pantry & Cooking", store: "Walmart", price: 7.14, isOrganic: true, preferredBrand: "Bob's Red Mill", bioengineered: false, alternatives: [] },
      { id: 62, name: "Bertolli Olive Oil", category: "Pantry & Cooking", store: "Publix", price: 15.49, isOrganic: false, preferredBrand: "Bertolli", bioengineered: false, alternatives: [] },
      
      // BEVERAGES
      { id: 65, name: "Yes Way Ros√© Cans", category: "Beverages & Wine", store: "Publix", price: 21.89, isOrganic: false, preferredBrand: "Yes Way", bioengineered: false, alternatives: [] },
    ];

    function GroceryApp() {
      const [groceries, setGroceries] = useState(() => {
        const saved = localStorage.getItem('smartGroceryList');
        return saved ? JSON.parse(saved) : initialGroceries;
      });
      
      const [weeklyList, setWeeklyList] = useState([]);
      const [isGenerating, setIsGenerating] = useState(false);
      const [lastGenerated, setLastGenerated] = useState(() => localStorage.getItem('lastGenerated') || null);
      const [apiKey, setApiKey] = useState(() => localStorage.getItem('anthropicApiKey') || '');
      const [showApiKeyInput, setShowApiKeyInput] = useState(!localStorage.getItem('anthropicApiKey'));
      const [publixAdUrl] = useState('https://www.publix.com/savings/weekly-ad');
      const [selectedItems, setSelectedItems] = useState(new Set());
      const [showAddItem, setShowAddItem] = useState(false);
      const [searchTerm, setSearchTerm] = useState('');
      const [filterCategory, setFilterCategory] = useState('All');
      const [filterStore, setFilterStore] = useState('All');
      
      const [newItem, setNewItem] = useState({
        name: '',
        category: 'Produce',
        store: 'Publix',
        price: '',
        isOrganic: false,
        bioengineered: false,
        preferredBrand: '',
        alternatives: ''
      });

      useEffect(() => {
        localStorage.setItem('smartGroceryList', JSON.stringify(groceries));
      }, [groceries]);

      const addNewItem = () => {
        if (!newItem.name) {
          alert('Please enter an item name');
          return;
        }
        
        const item = {
          id: Date.now(),
          name: newItem.name,
          category: newItem.category,
          store: newItem.store,
          price: parseFloat(newItem.price) || 0,
          isOrganic: newItem.isOrganic,
          bioengineered: newItem.bioengineered,
          preferredBrand: newItem.preferredBrand || 'Any',
          alternatives: newItem.alternatives ? newItem.alternatives.split(',').map(a => a.trim()) : []
        };
        
        setGroceries([...groceries, item]);
        setNewItem({
          name: '',
          category: 'Produce',
          store: 'Publix',
          price: '',
          isOrganic: false,
          bioengineered: false,
          preferredBrand: '',
          alternatives: ''
        });
        setShowAddItem(false);
      };

      const toggleItemSelection = (itemId) => {
        const newSelected = new Set(selectedItems);
        if (newSelected.has(itemId)) {
          newSelected.delete(itemId);
        } else {
          newSelected.add(itemId);
        }
        setSelectedItems(newSelected);
      };

      const exportSelectedItems = () => {
        const selected = groceries.filter(item => selectedItems.has(item.id));
        const byStore = selected.reduce((acc, item) => {
          if (!acc[item.store]) acc[item.store] = [];
          acc[item.store].push(item);
          return acc;
        }, {});

        let output = `üõí MY SHOPPING LIST - ${new Date().toLocaleDateString()}\n\n`;
        
        Object.entries(byStore).forEach(([store, items]) => {
          const total = items.reduce((sum, item) => sum + item.price, 0);
          output += `‚îÅ‚îÅ‚îÅ ${store.toUpperCase()} ‚îÅ‚îÅ‚îÅ\n`;
          output += `${items.length} items ‚Ä¢ Est. $${total.toFixed(2)}\n\n`;
          
          items.forEach(item => {
            output += `‚òê ${item.name}`;
            if (item.price) output += ` - $${item.price.toFixed(2)}`;
            output += '\n';
            if (item.bioengineered) output += `  ‚ö†Ô∏è Contains bioengineered ingredients\n`;
          });
          output += '\n';
        });

        const grandTotal = selected.reduce((sum, item) => sum + item.price, 0);
        output += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
        output += `TOTAL: $${grandTotal.toFixed(2)} (${selectedItems.size} items)\n`;

        navigator.clipboard.writeText(output);
        alert('‚úÖ Shopping list copied to clipboard!');
      };

      const generateWeeklyList = async () => {
        if (!apiKey) {
          alert('Please enter your Anthropic API key first');
          setShowApiKeyInput(true);
          return;
        }

        setIsGenerating(true);
        console.log('Starting weekly list generation...');
        
        try {
          console.log('Calling /api/anthropic endpoint...');
          
          // Call our serverless function instead of Anthropic API directly
          const response = await fetch('/api/anthropic', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              apiKey: apiKey,
              prompt: `Fetch the current Publix weekly ad from ${publixAdUrl} and extract ALL Buy One Get One Free (BOGO) items.

Then match against this master list and suggest alternatives:

Master List:
${groceries.map(item => `- ${item.name} ($${item.price.toFixed(2)}, ${item.store}, ${item.isOrganic ? 'Organic' : 'Conventional'}, Bioengineered: ${item.bioengineered ? 'Yes' : 'No'})`).join('\n')}

Preferences:
- Prefer organic when possible
- NEVER suggest bioengineered items
- Suggest budget swaps
- Respect preferred brands

Provide response in this JSON format (NO markdown, just JSON):
{
  "bogoMatches": [{"itemName": "Item from list", "reason": "Why it matches"}],
  "alternatives": [{"instead": "Item from list", "suggestion": "Alternative on BOGO", "reason": "Why better", "savings": "$2"}],
  "warnings": [{"item": "Item name", "warning": "Bioengineered warning"}],
  "budgetSwaps": [{"from": "Expensive item", "to": "Budget option", "savings": "$3"}]
}`
            })
          });

          console.log('Response status:', response.status);
          console.log('Response headers:', [...response.headers.entries()]);
          
          const data = await response.json();
          console.log('Response data:', data);
          
          // Check for API errors
          if (data.error) {
            console.error('API Error:', data.error);
            throw new Error(`API Error: ${data.error.message || JSON.stringify(data.error)}`);
          }
          
          if (!response.ok) {
            console.error('HTTP Error:', response.status, data);
            throw new Error(`API returned status ${response.status}: ${data.error?.message || 'Check your API key and billing credits'}`);
          }
          
          let responseText = '';
          if (data.content) {
            for (const block of data.content) {
              if (block.type === 'text') {
                responseText += block.text;
              }
            }
          }

          const cleanJson = responseText.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
          const results = JSON.parse(cleanJson);
          
          const list = [];
          
          results.bogoMatches?.forEach(match => {
            const item = groceries.find(g => g.name.toLowerCase().includes(match.itemName.toLowerCase()));
            if (item) {
              list.push({ ...item, matchType: 'bogo', reason: match.reason, priority: 1 });
            }
          });
          
          results.alternatives?.forEach(alt => {
            list.push({
              name: alt.suggestion,
              category: 'Alternative',
              store: 'Publix',
              price: 0,
              matchType: 'alternative',
              reason: alt.reason,
              originalItem: alt.instead,
              savings: alt.savings,
              priority: 2
            });
          });
          
          results.warnings?.forEach(warn => {
            const item = groceries.find(g => g.name.toLowerCase().includes(warn.item.toLowerCase()));
            if (item) {
              list.push({ ...item, matchType: 'warning', warning: warn.warning, priority: 3 });
            }
          });
          
          results.budgetSwaps?.forEach(swap => {
            list.push({
              name: swap.to,
              category: 'Budget Swap',
              store: 'Publix',
              price: 0,
              matchType: 'budget',
              reason: `Saves ${swap.savings} vs ${swap.from}`,
              priority: 2
            });
          });

          list.sort((a, b) => a.priority - b.priority);
          
          setWeeklyList(list);
          const now = new Date().toLocaleDateString();
          setLastGenerated(now);
          localStorage.setItem('lastGenerated', now);
          
        } catch (error) {
          let errorMsg = 'Error generating weekly list. ';
          
          if (error.message && error.message.includes('fetch')) {
            errorMsg += 'Network error - check your internet connection.';
          } else if (error.message && error.message.includes('JSON')) {
            errorMsg += 'Could not parse response from AI. Try again.';
          } else {
            errorMsg += 'Details: ' + (error.message || 'Unknown error');
          }
          
          alert(errorMsg + '\n\nCheck browser console (F12) for more details.');
          console.error('Full error:', error);
        } finally {
          setIsGenerating(false);
        }
      };

      const filteredGroceries = () => {
        return groceries.filter(item => {
          const matchesSearch = item.name.toLowerCase().includes(searchTerm.toLowerCase());
          const matchesCategory = filterCategory === 'All' || item.category === filterCategory;
          const matchesStore = filterStore === 'All' || item.store === filterStore;
          return matchesSearch && matchesCategory && matchesStore;
        });
      };

      return (
        <div className="min-h-screen p-6 max-w-7xl mx-auto">
          <div className="bg-gradient-to-r from-green-600 to-green-700 rounded-lg shadow-lg p-6 mb-6 text-white">
            <h1 className="text-4xl font-bold mb-2">ü§ñ Smart Grocery Assistant</h1>
            <p className="text-green-100">Your AI-powered weekly shopping companion</p>
          </div>

          {showApiKeyInput && (
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
              <h3 className="font-semibold text-blue-900 mb-2">üîë Setup: Add your Anthropic API Key</h3>
              <p className="text-sm text-blue-700 mb-3">Get it at <a href="https://console.anthropic.com" target="_blank" className="underline">console.anthropic.com</a></p>
              <div className="flex gap-2">
                <input
                  type="password"
                  value={apiKey}
                  onChange={(e) => setApiKey(e.target.value)}
                  placeholder="sk-ant-..."
                  className="flex-1 px-3 py-2 border border-blue-300 rounded"
                />
                <button onClick={() => { setShowApiKeyInput(false); localStorage.setItem('anthropicApiKey', apiKey); }} className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                  Save
                </button>
              </div>
            </div>
          )}

          <div className="grid md:grid-cols-2 gap-6 mb-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold mb-4 text-gray-800">üìã Generate This Week's List</h2>
              <p className="text-gray-600 mb-4 text-sm">Automatically fetch Publix BOGOs and match your items</p>
              
              {lastGenerated && (
                <p className="text-xs text-gray-500 mb-4">Last generated: {lastGenerated}</p>
              )}
              
              <button 
                onClick={generateWeeklyList}
                disabled={isGenerating}
                className="w-full px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 font-bold disabled:from-gray-300 disabled:to-gray-400 shadow-lg mb-4"
              >
                {isGenerating ? <span className="pulse">ü§ñ Analyzing...</span> : '‚ú® Generate Weekly Deals'}
              </button>

              <button 
                onClick={() => setShowAddItem(!showAddItem)}
                className="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-semibold"
              >
                {showAddItem ? '‚úï Cancel' : '‚ûï Add New Item to Master List'}
              </button>

              {showAddItem && (
                <div className="mt-4 p-4 bg-gray-50 rounded space-y-3">
                  <input
                    type="text"
                    value={newItem.name}
                    onChange={(e) => setNewItem({...newItem, name: e.target.value})}
                    placeholder="Item name"
                    className="w-full px-3 py-2 border rounded"
                  />
                  <div className="grid grid-cols-2 gap-2">
                    <select value={newItem.category} onChange={(e) => setNewItem({...newItem, category: e.target.value})} className="px-3 py-2 border rounded">
                      {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                    </select>
                    <select value={newItem.store} onChange={(e) => setNewItem({...newItem, store: e.target.value})} className="px-3 py-2 border rounded">
                      <option value="Publix">Publix</option>
                      <option value="Walmart">Walmart</option>
                    </select>
                  </div>
                  <input
                    type="number"
                    step="0.01"
                    value={newItem.price}
                    onChange={(e) => setNewItem({...newItem, price: e.target.value})}
                    placeholder="Price (optional)"
                    className="w-full px-3 py-2 border rounded"
                  />
                  <input
                    type="text"
                    value={newItem.preferredBrand}
                    onChange={(e) => setNewItem({...newItem, preferredBrand: e.target.value})}
                    placeholder="Preferred brand (optional)"
                    className="w-full px-3 py-2 border rounded"
                  />
                  <div className="flex gap-4">
                    <label className="flex items-center gap-2">
                      <input type="checkbox" checked={newItem.isOrganic} onChange={(e) => setNewItem({...newItem, isOrganic: e.target.checked})} />
                      <span className="text-sm">Organic</span>
                    </label>
                    <label className="flex items-center gap-2">
                      <input type="checkbox" checked={newItem.bioengineered} onChange={(e) => setNewItem({...newItem, bioengineered: e.target.checked})} />
                      <span className="text-sm text-red-600">Bioengineered</span>
                    </label>
                  </div>
                  <button onClick={addNewItem} className="w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-semibold">
                    Add to Master List
                  </button>
                </div>
              )}
            </div>

            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold mb-4 text-gray-800">‚úÖ Build Manual List</h2>
              <p className="text-gray-600 mb-4 text-sm">Check items you need this week</p>
              
              <div className="flex gap-2 mb-4">
                <input
                  type="text"
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  placeholder="üîç Search..."
                  className="flex-1 px-3 py-2 border rounded text-sm"
                />
                <select value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)} className="px-3 py-2 border rounded text-sm">
                  <option value="All">All</option>
                  {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                </select>
                <select value={filterStore} onChange={(e) => setFilterStore(e.target.value)} className="px-3 py-2 border rounded text-sm">
                  <option value="All">All Stores</option>
                  <option value="Publix">Publix</option>
                  <option value="Walmart">Walmart</option>
                </select>
              </div>

              <div className="text-sm text-gray-600 mb-2">
                {selectedItems.size} items selected
              </div>

              <div className="max-h-[400px] overflow-y-auto space-y-2 mb-4">
                {filteredGroceries().map(item => (
                  <div
                    key={item.id}
                    onClick={() => toggleItemSelection(item.id)}
                    className={`p-3 border rounded cursor-pointer hover:shadow transition ${selectedItems.has(item.id) ? 'selected-item' : 'bg-white'} ${item.bioengineered ? 'border-red-300' : 'border-gray-200'}`}
                  >
                    <div className="flex items-start gap-3">
                      <input
                        type="checkbox"
                        checked={selectedItems.has(item.id)}
                        onChange={() => {}}
                        className="mt-1"
                      />
                      <div className="flex-1">
                        <div className="font-semibold text-gray-900">{item.name}</div>
                        <div className="text-xs text-gray-600 mt-1">
                          <span className="text-blue-600 font-medium">{item.store}</span>
                          {' ‚Ä¢ '}
                          <span>${item.price.toFixed(2)}</span>
                          {item.isOrganic && <span className="ml-2 text-green-600">üåø Organic</span>}
                          {item.bioengineered && <span className="ml-2 text-red-600">‚ö†Ô∏è Bioengineered</span>}
                        </div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>

              <button 
                onClick={exportSelectedItems}
                disabled={selectedItems.size === 0}
                className="w-full px-4 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 font-bold disabled:bg-gray-300"
              >
                üìã Export List ({selectedItems.size} items)
              </button>
            </div>
          </div>

          {weeklyList.length > 0 && (
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-4">üéØ AI-Generated Weekly Deals</h2>
              <div className="space-y-3">
                {weeklyList.map((item, idx) => {
                  const bgClass = item.matchType === 'bogo' ? 'bogo-match' : 
                                  item.matchType === 'alternative' ? 'alternative-match' :
                                  item.matchType === 'warning' ? 'bioengineered-warning' : 
                                  'bg-white border border-gray-200';
                  
                  const icon = item.matchType === 'bogo' ? '‚≠ê' :
                              item.matchType === 'alternative' ? 'üí°' :
                              item.matchType === 'budget' ? 'üí∞' :
                              item.matchType === 'warning' ? '‚ö†Ô∏è' : '‚Ä¢';

                  return (
                    <div key={idx} className={`p-4 rounded-lg ${bgClass} shadow-sm`}>
                      <div className="flex items-start justify-between">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-1">
                            <span className="text-xl">{icon}</span>
                            <span className="font-bold text-gray-900">{item.name}</span>
                            {item.price > 0 && <span className="text-sm text-gray-600">${item.price.toFixed(2)}</span>}
                          </div>
                          {item.reason && <p className="text-sm text-gray-700 ml-7">{item.reason}</p>}
                          {item.originalItem && <p className="text-xs text-gray-600 ml-7 mt-1">Instead of: {item.originalItem}</p>}
                          {item.savings && <p className="text-xs font-semibold text-green-700 ml-7 mt-1">Save {item.savings}</p>}
                          {item.warning && <p className="text-sm text-red-700 ml-7 font-medium">{item.warning}</p>}
                        </div>
                        <span className="text-xs text-gray-500 ml-4">{item.store}</span>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<GroceryApp />, document.getElementById('root'));
  </script>
</body>
</html>